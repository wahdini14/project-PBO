<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil</title>
    <link rel="stylesheet" th:href="@{/css/profilestyle.css}">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,400,0,0" />
</head>

<body>
<div class="container">

    <!-- SIDEBAR -->
    <aside>
        <div class="top">
            <div class="logo">
                <h2>Kerja<span class="danger">Kilat</span></h2>
            </div>
        </div>

        <div class="sidebar">
            <a th:href="@{/dashboard}">
                <span class="material-symbols-sharp"> grid_view </span>
                <h3>Dashboard</h3>
            </a>

            <a th:href="@{/tambahpekerjaan}">
                <span class="material-symbols-sharp"> add_notes </span>
                <h3>Tambahkan Pekerjaan</h3>
            </a>

            <a th:href="@{/pekerjaansaya}">
                <span class="material-symbols-sharp"> work </span>
                <h3>Pekerjaan Saya</h3>
                <span th:if="${acceptedNotifications != null and acceptedNotifications > 0}" class="notif-badge" th:text="${acceptedNotifications}"></span>
            </a>

            <a th:href="@{/message}">
                <span class="material-symbols-sharp"> message </span>
                <h3>Pesan</h3>
            </a>

            <a th:href="@{/profile}" th:classappend="${isOwner} ? 'active' : ''">
                <span class="material-symbols-sharp"> account_circle </span>
                <h3>Profil</h3>
            </a>

            <a href="javascript:void(0)" onclick="openLogoutPopup()">
                <span class="material-symbols-sharp"> logout </span>
                <h3>Keluar</h3>
            </a>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="content">
        <div class="profile-header-wrapper">
    
            <div class="profile-header">
                <!-- FOTO PROFIL -->
                <img th:if="${user.profileImage != null}"
                    th:src="@{'/uploads/' + ${user.profileImage}}"
                    alt="Foto Profil"
                    class="profile-photo">

                <span th:if="${user.profileImage == null}"
                    class="material-symbols-sharp profile-icon">
                    account_circle
                </span>

                <div class="profile-info">
                    <h1 th:text="${user.fullName}">Nama</h1>
                    <h3 th:text="${user.job}">Pekerjaan</h3>

                    <!-- Rating removed as requested -->

                    <p class="desc" th:text="${user.description}">
                        Deskripsi diri belum diisi.
                    </p>
                </div>
        </div>

    <a th:if="${isOwner}" th:href="@{/profile/edit}" class="edit-btn">Edit Profil</a>

</div>

        <!-- INFO RINGKAS -->
        <div class="info-row">
            <div class="info-box">
                <span class="material-symbols-sharp"> location_on </span>
                <div>
                    <h4>Lokasi</h4>
                    <p th:text="${user.location}">Belum diisi</p>
                </div>
            </div>

            <div class="info-box">
                <span class="material-symbols-sharp"> phone </span>
                <div>
                    <h4>Telepon</h4>
                    <p th:text="${user.phone}">Belum diisi</p>
                </div>
            </div>
        </div>

        <!-- PENGALAMAN -->
        <h2 class="section-title">Pengalaman Kerja</h2>

        <div class="experience-box">

            <!-- Jika user punya pengalaman -->
            <div th:if="${user.expTitle != null}">
                <h4 th:text="${user.expTitle}">Judul Pengalaman</h4>
                <p class="date">
                    <span th:text="${user.expStart}">2019</span> – 
                    <span th:text="${user.expEnd}">2020</span>
                </p>

                <ul>
                    <li th:text="${user.expCompany}">Nama Tempat Kerja</li>
                    <li th:text="${user.expDescription}">Deskripsi Pekerjaan</li>
                </ul>
            </div>

            <!-- Jika user tidak punya pengalaman -->
            <div th:if="${user.expTitle == null}">
                <h4>Belum ada pengalaman yang ditambahkan.</h4>
                <p class="date">—</p>

                <ul>
                    <li>Tambahkan pengalaman kerja melalui halaman Edit Profil.</li>
                </ul>
            </div>

        </div>


    </main>

</div>

<!-- LOGOUT CONFIRMATION POPUP -->
<div class="logout-overlay" id="logoutPopup" style="display: none;">
    <div class="logout-box">
        <h3>Apa kamu yakin ingin keluar?</h3>

        <div class="logout-actions">
            <button class="btn-yes" onclick="confirmLogout()">Ya</button>
            <button class="btn-no" onclick="closeLogoutPopup()">Tidak</button>
        </div>
    </div>
</div>

<script>
    function openLogoutPopup() {
    document.getElementById("logoutPopup").style.display = "flex";
    }
    function closeLogoutPopup() {
        document.getElementById("logoutPopup").style.display = "none";
    }
function confirmLogout() {
    window.location.href = "/logout";
}
</script>
</body>
</html>

<!-- 
    profile.html (Template View)
    Tanggung Jawab: Menampilkan profil lengkap user (diri sendiri atau user lain), termasuk info personal, contact, dan pengalaman kerja.
    Komponen Utama:
    - Sidebar navigasi (sama seperti dashboard, active link hanya tampil untuk owner viewing own profile).
    - Profile header: foto profil (atau icon default), nama, pekerjaan, deskripsi personal.
    - "Edit Profil" button (hanya tampil jika isOwner = true).
    - Info box: Lokasi, Telepon.
    - Pengalaman Kerja section: menampilkan ekspjabatan, perusahaan, tanggal, deskripsi (atau pesan "Belum ada pengalaman" jika kosong).
    Fitur:
    - Responsive untuk menampilkan profile orang lain (user tidak bisa edit profile orang lain).
    - "Edit Profil" → redirect ke /profile/edit (hanya untuk owner).
    - Logout confirmation popup.
    Data dari Controller:
    - user: User object dengan semua field (fullName, job, location, phone, description, profile image, experience).
    - isOwner: Boolean untuk menentukan apakah current user adalah pemilik profile.
    SOLID Principles:
    - Single Responsibility: Template fokus pada presentasi profil user, business logic di ProfileController.
    - Separation of Concerns: Ownership check dilakukan di backend, template hanya conditionally render elements.
-->